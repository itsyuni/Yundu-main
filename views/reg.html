<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è | Yundu</title>

    <link rel="icon" type="image/png" href="https://assets.yundu.co/icon.png" />
    <style>
      @font-face {
        font-family: "Gotham Pro";
        src: url("https://assets.yundu.co/GothamPro.ttf");
      }
      @font-face {
        font-family: "Gotham";
        src: url("https://assets.yundu.co/gotham.ttf");
      }
      @font-face {
        font-family: "Montserrat";
        src: url("https://assets.yundu.co/montserrat.ttf");
      }
      @font-face {
        font-family: "Montserrat Medium";
        src: url("https://assets.yundu.co/montserratmedium.ttf");
      }
      @font-face {
        font-family: "Montserrat SemiBold";
        src: url("https://assets.yundu.co/bold.ttf");
      }
      :root {
        --brand: #33d190;
        --brand-focus: #28c282;
        --error: #f36666;
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        background: #f9f9f9;
        margin: 0;
        padding: 0;
        font-size: 1em;
        padding-bottom: 20px;
        overflow-x: hidden;
        user-select: none;
      }
      p,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        margin: 0;
      }
      :focus {
        outline: none;
      }
      p,
      span {
        font-weight: 600;
        line-height: 1.2em;
        font-size: 1em;
        letter-spacing: 0.3px;
        font-family: "Gotham Pro";
      }
      h1,
      h2 {
        font-family: "Montserrat";
      }
      h3,
      h4,
      h5,
      h6 {
        font-family: "Montserrat SemiBold";
      }
      header {
        padding: 20px 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      ::selection {
        color: white;
        background: var(--brand);
      }
      .logo {
        width: 40px;
        height: 40px;
      }
      .logo svg {
        width: 40px;
        height: 40px;
      }
      main {
        width: 200vw;
        transform: translateX(0);
        transition: transform 0.5s;
        display: flex;
      }
      main h3:first-of-type {
        font-size: 1.5em;
        margin-bottom: 5px;
      }
      input:not([type="submit"]) {
        border: 2.2px solid #0000000d;
        border-radius: 10px;
        background: white;
        color: black;
        font-size: 1em;
        font-family: "Gotham";
        position: relative;
        padding: 12px;
        width: 100%;
        transition: border-color 0.3s;
      }
      input:not([type="submit"]):focus {
        border-color: var(--brand) !important;
      }
      .name {
        margin-top: 7px;
      }
      label:not(.inputed){
        font-family: "Gotham Pro";
        font-weight: 600;
        display: block;
        font-size: 0.9em;
        width:fit-content;
        margin-bottom: 3px;
      }
      label:not(.name) {
        margin-top: 12px;
      }
      button {
        border:none;
            color:white;
            user-select: none;
            background:var(--brand);
            border-radius:8px;
            padding:10px 12px;
            font-family: 'Gotham';
            font-size:1em;
            margin-top:12px;
            transition: background .3s;
      }
      input:-webkit-autofill,
  input:-webkit-autofill:hover,
  input:-webkit-autofill:focus textarea:-webkit-autofill,
  textarea:-webkit-autofill:hover textarea:-webkit-autofill:focus,
  select:-webkit-autofill,
  select:-webkit-autofill:hover,
  select:-webkit-autofill:focus {
    box-shadow: 0 0 0px 1000px #ffffff inset !important;
  }
      button:hover {
        background: var(--brand-focus);
      }
      .error {
        background: #ec4b4b40;
        padding: 23px;
        display: none;
        margin: 10px 0;
        border-radius: 11px;
        justify-content: center;
        align-items: center;
      }
      .error svg {
        width: 47px;
        margin-right: 12px;
        height: 47px;
      }
      .error svg path {
        fill: #ea4848;
      }
      .error > div {
        width: fit-content;
      }
      .error p {
        width: fit-content;
        color: #ea4848;
      }
      .error p:first-of-type {
        font-size: 1.1em;

        font-family: "Montserrat Medium";
      }
      input,
      button {
        -webkit-appearance: none;
        appearance: none;
      }
      .page1,
      .page2 {
        width: 100vw;
        flex-flow: wrap;
        padding: 0 20px;
      }
      main.switched {
        transform: translateX(-100vw);
      }
      .back {
        margin-top: 10px;
      }
      .preview {
        width: calc(100vw - 40px);
        height: calc(100vw - 40px);
        overflow: hidden;
        border: 2.2px solid transparent;
        border-radius: 25px;
        -webkit-transition: all 1s cubic-bezier(0, 1, 0, 1);
        -moz-transition: all 1s cubic-bezier(0, 1, 0, 1);
        -ms-transition: all 1s cubic-bezier(0, 1, 0, 1);
        -o-transition: all 1s cubic-bezier(0, 1, 0, 1);
        transition: all 1s cubic-bezier(0, 1, 0, 1);
        margin-top: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        transform: translateZ(0);
        justify-content: center;
        max-height: 500px;
        flex-direction:column;
        background: white;
        position: relative;
      }

      .preview div p,
      .preview div h2 {
        text-align: center;
        color: black;
      }
      .preview div span {
        color: var(--brand);
      }
      .preview div p {
        font-size: 1.1em;
      }
      .preview div h1 {
        text-align: center;
        font-size: 2.7em;
        margin-bottom: 5px;
      }
      .next {
        background: #cacaca;
        margin-top: 15px;
        transition: background 1s;
      }
      .next:not(:disabled):hover {
        background: var(--brand-focus);
      }
      .next:not(:disabled) {
        background: var(--brand);
      }
      .tip {
        color: #969090;
        margin-top: 15px;
        text-align: center;
      }
      .tip span {
        color: var(--brand);
      }

      .dop {
        display: none;
      }
      .video {
        min-width: 100%;
        min-height: 100%;
        width: auto;
        height: auto;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scaleX(-1);
        display: flex;
        justify-content: center;
        align-items: center;
flex-direction:column;
      }
      .photo {
        margin-top: 10px;
        transition: background 1s;
      }
      .video svg {
        width: 100px;
        height: 100px;
      }
      p[class$="hidden"]{
        display: none;
        color: var(--error);
        font-size: 0.9em;
        margin-top: 5px;
      }
      .msg {
        color: var(--error);
        font-size: 0.9em;
        margin-top: 5px;
      }
      .avatar {
        background-color: white;
        height: 90px;
        width: 90px;
        border: 2.2px solid rgba(0, 0, 0, 0.05);
        border-radius: 50%;
        overflow: hidden;
        transition:border-color .3s;
        position: relative;
        margin: auto;
      }
      .avatar:hover {
    border-color: var(--brand);
}
      .avpreview {
        position: relative;
        width: fit-content;
        margin: auto;
      }

      input[type="file"] {
        display: none;
      }
      .avatar_delete {
        position: absolute;
        right: 0;
    bottom: -3px;
        background: rgb(243, 15, 15);
        border-radius: 50%;
        padding: 2px;
        width: 29px;
        visibility: hidden;
        height: 29px;
      }
      .avatar_delete svg {
        width: 25px;
        height: 25px;
      }
      .other {
        margin-top: 19px;
      }
      .other > p {
        font-size: 0.9em;
      }
      .other a p {
        width: fit-content;
        font-size: 0.95em;
        margin-top: 2px;
      }
      .avatar_default {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 40px;
        height: 40px;
      }
      a {
        text-decoration: none;
        color: var(--brand);
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        width: fit-content;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
      }
     .checkmark{
        position: absolute;
    top: 14px;
    right: 18px;
    visibility: hidden;
    width: 7px;
    height: 14px;
    opacity: 0;
    transition: visibility .2s linear, opacity .3s linear;
    border: solid #2ad956;
    border-width: 0 3px 3px 0;
    transform: rotate(45deg);
     }
     .checkmarked + .checkmark{
         opacity:1;
         visibility:visible;
     }
     .toApp{
      top: 50%;
    position: fixed;
    padding: 20px;
    left: 50%;
    transform: translate(-50%, -50%);
    border-radius: 20px;
    background: white;
     }
     .toAppBg{
       z-index:10;
       top:0;
       left:0;
    visibility:hidden;
    opacity:0;
       width:100%;height:100%;
       background:rgba(0,0,0,0.1);
       transition:visibility .3s, opacity .3s;
       position:fixed;
     }
     .toAppBg.active{
       visibility:visible;
       opacity:1;
     }
    </style>
  </head>
  <body>
    <div class="toAppBg"><div class="toApp"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto;background: rgb(255, 255, 255);display: block;shape-rendering: auto;width: 110px;height: 110px;" width="200px" height="200px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
      <circle cx="50" cy="50" fill="none" stroke="#3adc99" stroke-width="10" r="35" stroke-dasharray="164.93361431346415 56.97787143782138">
        <animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="0.8s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform>
      </circle></svg></div></div>
    <header>
      <div class="logo">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          version="1.1"
          id="–°–ª–æ–π_1"
          x="0px"
          y="0px"
          viewBox="0 0 2000 2000"
          style="enable-background: new 0 0 2000 2000"
          xml:space="preserve"
        >
          <style type="text/css">
            .st0 {
              fill: #33d190;
              stroke: #33d190;
              stroke-width: 35.1913;
              stroke-miterlimit: 10;
            }
          </style>
          <path
            class="st0"
            d="M1689.3,243.1h-175.1c0,284.6-230.7,515.3-515.3,515.3S483.7,527.7,483.7,243.1h-173c0,0.3,0,0.7,0,1  c0,380.8,308.6,689.4,689.4,689.4s689.4-308.6,689.4-689.4C1689.3,243.8,1689.3,243.4,1689.3,243.1z"
          />
          <g>
            <path
              class="st0"
              d="M1689.3,1267.6h-175.1c0,284.6-230.7,515.3-515.3,515.3s-515.3-230.7-515.3-515.3h-173c0,0.3,0,0.7,0,1   c0,380.8,308.6,689.4,689.4,689.4s689.4-308.6,689.4-689.4C1689.3,1268.3,1689.3,1267.9,1689.3,1267.6z"
            />
          </g>
          <rect
            x="1514.2"
            y="243.1"
            class="st0"
            width="175.1"
            height="1024.6"
          />
          <circle class="st0" cx="819.9" cy="166.7" r="124.7" />
          <circle class="st0" cx="1178" cy="166.7" r="124.7" />
        </svg>
      </div>
    </header>
    <main>
      <div class="page1">
        <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
        <div class="error">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            enable-background="new 0 0 24 24"
            viewBox="0 0 24 24"
          >
            <path
              d="M21.7,7.6l-5.3-5.3C16.2,2.1,16,2,15.7,2H8.3C8,2,7.8,2.1,7.6,2.3L2.3,7.6C2.1,7.8,2,8,2,8.3v7.5c0,0.3,0.1,0.5,0.3,0.7l5.3,5.3C7.8,21.9,8,22,8.3,22h7.5c0.3,0,0.5-0.1,0.7-0.3l5.3-5.3c0.2-0.2,0.3-0.4,0.3-0.7V8.3C22,8,21.9,7.8,21.7,7.6z M12,17c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S12.6,17,12,17z M13,12c0,0.6-0.4,1-1,1s-1-0.4-1-1V8c0-0.6,0.4-1,1-1s1,0.4,1,1V12z"
            />
          </svg>
          <div>
            <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –ø–æ–ª—è.</p>
          </div>
        </div>
        <div style="display: flex">
          <div>
            <label for="name" class="name">–ò–º—è:</label>
            <div style="position:relative;"><input type="text" id="name" class="names" placeholder="–ò–≤–∞–Ω" /><div class="checkmark"></div></div>
          </div>
          <div style="margin-left: 8px">
            <label for="surname" class="name">–§–∞–º–∏–ª–∏—è:</label>

            <div style="position:relative;"><input type="text" class="names" id="surname" placeholder="–ò–≤–∞–Ω–æ–≤" /><div class="checkmark"></div></div>
          </div>
        </div>
        
        <p class="namehidden"></p>
        <p class="surnamehidden"></p>
        <label for="username">–ù–∏–∫–Ω–µ–π–º:</label>
        <div style="position:relative;"><input type="text" id="username" placeholder="supervasya228" /><div class="checkmark"></div></div>
        <p class="usernamehidden"></p>
        <label for="email">–ü–æ—á—Ç–∞:</label>
        <div style="position:relative;"><input
          value=""
          type="email"
          id="email"
          placeholder="supervasya228@vasya.com"
        /><div class="checkmark"></div></div>
        <p class="emailhidden"></p>
        <div style="display: flex">
          <div>
            <label for="password">–ü–∞—Ä–æ–ª—å:</label>
            <div style="position:relative;"><input type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" id="password" /><div class="checkmark"></div></div>
          </div>
          <div style="margin-left: 8px">
            <label for="password2">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:</label>

            <div style="position:relative;"><input type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" id="password2" /><div class="checkmark"></div></div>
          </div>
        </div>
        <p class="passwordhidden"></p>
        <label for="avatar">–ê–≤–∞—Ç–∞—Ä:</label>
        <input type="file" id="avatar" accept="image/*" />
        <div class="avpreview">
          <div class="avatar">
            <svg
              class="avatar_default"
              xmlns="http://www.w3.org/2000/svg"
              enable-background="new 0 0 24 24"
              viewBox="0 0 24 24"
            >
              <path
                fill="var(--brand)"
                d="M12,12c2.8,0,5-2.2,5-5s-2.2-5-5-5S7,4.2,7,7S9.2,12,12,12z M21.3,20.8c-1.3-5.1-6.5-8.3-11.6-7c-3.4,0.9-6.1,3.5-7,7c-0.1,0.5,0.2,1.1,0.8,1.2c0.1,0,0.2,0,0.2,0h16.6c0.6,0,1-0.4,1-1C21.3,20.9,21.3,20.8,21.3,20.8z"
              />
            </svg>
          </div>
          <div class="avatar_delete">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              enable-background="new 0 0 24 24"
              viewBox="0 0 24 24"
            >
              <path
                fill="#FFFFFF"
                d="M13.4,12l4.3-4.3c0.4-0.4,0.4-1,0-1.4c-0.4-0.4-1-0.4-1.4,0L12,10.6L7.7,6.3c-0.4-0.4-1-0.4-1.4,0c-0.4,0.4-0.4,1,0,1.4l4.3,4.3l-4.3,4.3C6.1,16.5,6,16.7,6,17c0,0.6,0.4,1,1,1c0.3,0,0.5-0.1,0.7-0.3l4.3-4.3l4.3,4.3c0.2,0.2,0.4,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L13.4,12z"
              />
            </svg>
          </div>
        </div>
        <button class="submit">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        <p class="msg"></p>
        <div class="other">
          <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?</p>
          <a href="/login"><p>–í–æ–π–¥–∏—Ç–µ</p></a>
        </div>
      </div>
      <div class="page2">
        <h3 style="font-size: 1.5em">–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞</h3>
        <button class="back">–ù–∞–∑–∞–¥</button>
        <div class="preview">
            <div class="preview_content"></div>
          <video class="video">–û—à–∏–±–∫–∞.</video>
          <div class="retry"></div>
        </div>
        <div class="photo_div"><button class="photo">–°–Ω—è—Ç—å —Ñ–æ—Ç–æ</button></div>
        <canvas class="dop"> </canvas>
        <p class="tip">
          –°–µ–π—á–∞—Å –∏—Å–∫—É—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä—É–µ—Ç –≤–∞—à–µ –ª–∏—Ü–æ –∏ —É–∑–Ω–∞–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç.
          –î–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ <span>—Å–Ω–∏–º–∏—Ç–µ –æ—á–∫–∏</span> –∏
          <span>–¥–µ—Ä–∂–∏—Ç–µ –ª–∏—Ü–æ —Ä–æ–≤–Ω–æ</span>.
        </p>
        <button class="next" disabled>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
      </div>
    </main>
    <footer></footer>
    <script>
      let env;
      fetch("https://api.yundu.co/env")
        .then((response) => response.text())
        .then((text) => {
          env = text;

          if (
            localStorage.getItem("logged") &&
            localStorage.getItem("logged") == "true"
          ) {
            if (text == "production") {
              location.href = "https://app.yundu.co/";
            } else if (text == "development") {
              location.href = "/app/";
            }
          } else if (
            !localStorage.getItem("logged") ||
            localStorage.getItem("logged") == "false"
          ) {
            const fileinput = document.querySelector("input[type=file]");
            const avatarElem = document.querySelector(".avatar");
            const avatarDeleteElem = document.querySelector(".avatar_delete");
            const avatarDefaultElem = document.querySelector(".avatar_default");
            let finalFile = 0;
            const msgElem = document.querySelector(".msg");
            let usernameRegex = /^[a-zA-Z0-9._]*$/;
            let nameRegex = /^[\u0400-\u04FF ]+$/;
            const inputs = document.querySelectorAll(
              'input:not([type="file"])'
            );
            let errored = [];
            function initError(type, number){
              if(!errored.includes(type)){
                errored.push(type);
              }
                const element = userInputs[type];
                let hiddenValue = '';
                switch(type){
                    case "password":
                        switch(number){
                            case 1:
                                hiddenValue = '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π.'
                                break;
                            case 2:
                                hiddenValue = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç.'
                                break;
                        }
                        break;
                    case "password2":
                        switch(number){
                            case 1:
                                hiddenValue = '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π.'
                                break;
                            case 2:
                                hiddenValue = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç.'
                                break;
                        }
                        break;
                    case "username":
                        switch(number){
                            case 1:
                                hiddenValue = '–¢–∞–∫–æ–π –Ω–∏–∫–Ω–µ–π–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.';
                                break;
                            case 2:
                                hiddenValue = '–ù–∏–∫–Ω–µ–π–º –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –±—É–∫–≤, —Ü–∏—Ñ—Ä, —Ç–æ—á–µ–∫ –∏ –Ω–∏–∂–Ω–∏—Ö –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–π.';
                                break;
                        }
                        break;
                    case "email":
                        switch(number){
                            case 1:
                                hiddenValue = '–¢–∞–∫–∞—è –ø–æ—á—Ç–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.';
                                break;
                            case 2:
                                hiddenValue = '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è.';
                                break;
                        }
                        break;
                    case "name":
                        if(number == 1){
                            hiddenValue = '–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ —Ä—É—Å—Å–∫–∏—Ö –±—É–∫–≤.';
                        }
                        break;
                    case "surname":
                        if(number == 1){
                            hiddenValue = '–§–∞–º–∏–ª–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ —Ä—É—Å—Å–∫–∏—Ö –±—É–∫–≤.';
                        }
                        break;
                }
                if(type == 'password2'){
                    type = 'password'
                }
                    userHidden[type].style.display = 'block';
                    userHidden[type].innerText = hiddenValue;
                
element.style.borderColor = 'var(--error)'
if(element.classList.contains('checkmarked')){
    element.classList.remove('checkmarked');
}
element.onfocus = function () {
                this.onfocus = function () {};
                userHidden[type].style.display = "none";
                this.style.borderColor = "#0000000d";
};

            }
            const errorElem = document.querySelector(".error");
            const userInputs = {
              name: document.querySelector('input[id="name"]'),
              surname: document.querySelector('input[id="surname"]'),
              email: document.querySelector('input[id="email"]'),
              username: document.querySelector('input[id="username"]'),
              password: document.querySelector('input[id="password"]'),
              password2: document.querySelector('input[id="password2"]'),
            };
            const userInputsFiltered = {
              password: userInputs.password,
              email: userInputs.email,
              username: userInputs.username,
            };
            const userHidden = {
              email: document.querySelector(".emailhidden"),
              username: document.querySelector(".usernamehidden"),
              password: document.querySelector(".passwordhidden"),
              name:document.querySelector(".namehidden"),
              surname:document.querySelector(".surnamehidden")
            };
            function validateEmail(email) {
              const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
              return re.test(String(email).toLowerCase());
            }
            function getUsername() {
              var result = null,
                tmp = [];
              location.search
                .substr(1)
                .split("&")
                .forEach(function (item) {
                  tmp = item.split("=");
                  if (tmp[0] === "username")
                    result = decodeURIComponent(tmp[1]);
                });
              return result;
            }
            let startuped = false;
            
            document.querySelectorAll('.names').forEach((input)=>{
                input.onblur = function(){
                  
                  let inputName = this.getAttribute('id');
                    let value = this.value;
                    this.value = value.charAt(0).toUpperCase() + value.slice(1).toLowerCase();
                    
                    if (this.value != "") {
                      if(!nameRegex.test(value)){
                        if(this.getAttribute("id") == 'name'){
                          initError('name',1);
                    }
                    else{
                      initError('surname',1);
                    }
                  
                }
                else{
                    this.classList.add('checkmarked');
                    let inputName = this.getAttribute('id');
                    if(errored.includes(inputName)){
                      let index = errored.indexOf(inputName);
                        errored.splice(index,1)
                        this.style.borderColor = "#0000000d";
                    this.style.borderColor = "#0000000d";
                 userHidden[inputName].style.display = "none";
                 
                    }
                }}
                else{
                  errored.push(inputName);
                  this.style.borderColor = "var(--error)";
                }
                input.onfocus = function () {
                this.onfocus = function () {};
                this.style.borderColor = "#0000000d";
              };
                }
            })
            userInputs.password.onblur = function () {
              
              let inputName = this.getAttribute('id');
                if(this.value.length >= 6 && this.value.length != 0){
                if(this.value != userInputs.password2.value && userInputs.password2.value.length != 0) {
                initError('password',2);
               userInputs.password2.style.borderColor = "var(--error)";
               if(userInputs.password2.classList.contains('checkmarked')){
                 userInputs.password2.classList.remove('checkmarked');
               }
            }
              else if(this.value == userInputs.password2.value && userInputs.password2.value.length != 0){
                if (this.value == "") {
                  
                  errored.push(inputName);
                  this.style.borderColor = "var(--error)";
                } else {

                    this.classList.add('checkmarked');
                    
                    userInputs.password2.classList.add('checkmarked');
                    if(errored.includes(inputName)){
                      let index = errored.indexOf(inputName);
                        errored.splice(index,1)
                    this.style.borderColor = "#0000000d";
                    userInputs.password2.style.borderColor = "#0000000d";
                 userHidden.password.style.display = "none";
                  }
                  
                }
              }
              } else if(this.value.length < 6 && this.value.length != 0){
                
                initError('password',1);
              }
            };
            userInputs.password2.onblur = function () {
              let inputName = this.getAttribute('id');
                if(this.value == userInputs.password.value && userInputs.password.value.length != 0) {
                if(this.value.length < 6 && this.value.length != 0){
                initError('password2',1);
                
            }
              else if(this.value.length >= 6 && this.value.length != 0){
                if (this.value == "") {
                  
                  errored.push(inputName);
                  this.style.borderColor = "var(--error)";
                } else {
                    this.classList.add('checkmarked');
                    userInputs.password.classList.add('checkmarked');
                    if(errored.includes(inputName)){
                      let index = errored.indexOf(inputName);
                        errored.splice(index,1)
                    this.style.borderColor = "#0000000d";
                    userInputs.password.style.borderColor = "#0000000d";
                 userHidden.password.style.display = "none";
                  }
                  
                }
              }
              } else if(this.value != userInputs.password.value && userInputs.password.value.length != 0){
                initError('password2',2);
               userInputs.password.style.borderColor = "var(--error)";
               if(userInputs.password.classList.contains('checkmarked')){
                 userInputs.password.classList.remove('checkmarked');
               }
              }
              else if(this.value != userInputs.password.value && userInputs.password.value.length == 0){
                initError('password2',1);
              }
            };
           
            userInputs.username.onblur = function () {
              
              let inputName = this.getAttribute('id');
              if (this.value.length != 0) {
                if (usernameRegex.test(this.value)) {
                  fetch("https://api.yundu.co/username", {
                    method: "POST",
                    headers: {
                      "Content-Type": "application/json;charset=utf-8",
                    },
                    body: JSON.stringify({ username: this.value }),
                  })
                    .then((response) => {
                      return response.json();
                    })
                    .then((text) => {
                      if (text.msg == "exists") {
                        
                initError('username',1);
                      }
                      else{
                          
                    this.classList.add('checkmarked');
                         
                    if(errored.includes(inputName)){
                      let index = errored.indexOf(inputName);
                        errored.splice(index,1)
                        userHidden.username.style.display = "none";
                       this.style.borderColor = '#0000000d';
                          }
                      }
                    });
                } else {
                  
                initError('username',2);
                }
              } else {
                  errored.push(inputName);
                this.style.borderColor = "var(--error)";
              }
             
            };

            userInputs.email.onblur = function () {
              
              let inputName = this.getAttribute('id');
              if (this.value != "") {
                if (!validateEmail(this.value)) {
                  initError('email',2)
                } else {
                  fetch("https://api.yundu.co/email", {
                    method: "POST",
                    headers: {
                      "Content-Type": "application/json;charset=utf-8",
                    },
                    body: JSON.stringify({ email: this.value }),
                  })
                    .then((response) => {
                      return response.json();
                    })
                    .then((text) => {
                      if (text.msg == "exists") {
                       initError('email',1)
                      } else {
                          
                    this.classList.add('checkmarked');
                          
                    if(errored.includes(inputName)){
                      let index = errored.indexOf(inputName);
                        errored.splice(index,1)
                        userHidden.email.style.display = "none";
                        this.style.borderColor = '#0000000d';
                    }
                }
                    });
                }
              } else {
                  errored.push(inputName);
                this.style.borderColor = "var(--error)";
              }

              
            };
            document.querySelector(".submit").onclick = function () {
              
              for (let i = 0; i < inputs.length; i++) {
                if (inputs[i].value == "") {
                  inputs[i].style.borderColor = "var(--error)";
                  let inputName = inputs[i].getAttribute('id')
                  errored.push(inputName);
                }
              }
              
              if (errored.length > 0) {
                errorElem.style.display = "flex";
              } else {
                document.querySelector("main").classList.add("switched");
                errorElem.style.display = "none";
                if (startuped === false) {
                  startup();
                  startuped = true;
                }
              }
            };
            document.querySelector(".back").onclick = function () {
              document.querySelector("main").classList.remove("switched");
            };
            if (getUsername()) {
              userInputs.username.value = getUsername();

              if (userInputs.username.value.length != 0) {
                if (usernameRegex.test(userInputs.username.value)) {
                  fetch("https://api.yundu.co/username", {
                    method: "POST",
                    headers: {
                      "Content-Type": "application/json;charset=utf-8",
                    },
                    body: JSON.stringify({
                      username: userInputs.username.value,
                    }),
                  })
                    .then((response) => {
                      return response.json();
                    })
                    .then((text) => {
                      if (text.msg == "exists") {
                        errored.push('username')
                        userInputs.username.style.borderColor = "var(--error)";
                        userHidden.username.style.display = "block";

                        userHidden.username.innerText =
                          "–¢–∞–∫–æ–π –Ω–∏–∫–Ω–µ–π–º —É–∂–µ –µ—Å—Ç—å.";
                      }
                      else{

                        this.classList.add('checkmarked');
                          
                    if(errored.includes('username')){
                      let index = errored.indexOf('username');
                        errored.splice(index,1)
                        userHidden.username.style.display = "none";
                        this.style.borderColor = '#0000000d';
                    }
                      }
                    });
                } else {
                        errored.push('username')
                  userInputs.username.style.borderColor = "var(--error)";

                  userHidden.username.style.display = "block";
                  userHidden.username.innerText =
                    "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è.";
                }
              } else {
                        errored.push('username')
                userInputs.username.style.borderColor = "var(--error)";
              }
              userInputs.username.onfocus = function () {
                this.onfocus = function () {};
                
                userHidden.username.style.display = "none";
                userInputs.username.style.borderColor = "#0000000d";
              };
            }

            avatarElem.addEventListener("click", () => fileinput.click());

            fileinput.addEventListener("change", (event) => {
              const file = event.target.files[0];

              const reader = new FileReader();
              reader.readAsDataURL(file);

              reader.onloadend = () => {
                avatarElem.setAttribute("aria-label", file.name);
                avatarElem.style.background = `url(${reader.result}) center center/cover`;
                avatarDeleteElem.style.visibility = "visible";

                avatarDefaultElem.style.visibility = "hidden";
              };
            });
            avatarDeleteElem.onclick = function () {
              fileinput.value = "";
              avatarElem.style.background = "white";
              avatarElem.removeAttribute("aria-label");
              this.style.visibility = "hidden";

              avatarDefaultElem.style.visibility = "visible";
            };
            const nextElem = document.querySelector(".next");
            const previewElem = document.querySelector(".preview");
            let streaming = false;

            let video, canvas, startbutton, stream;
            function startup() {
              try {
                video = document.querySelector(".video");
                canvas = document.querySelector(".dop");
                startbutton = document.querySelector(".photo");
                stream = navigator.mediaDevices.getUserMedia({
                  video: true,
                  audio: false,
                });
                stream
                  .then(function (stream) {
                    video.srcObject = stream;
                    video.play();
                  })
                  .catch(function (err) {
                    console.log("An error occurred: " + err);
                  });

                video.addEventListener(
                  "canplay",
                  function (ev) {
                    if (!streaming) {
                      video.setAttribute("width", video.videoWidth);
                      video.setAttribute("height", video.videoHeight);
                      canvas.setAttribute("width", video.videoWidth);
                      canvas.setAttribute("height", video.videoHeight);
                      streaming = true;
                    }
                  },
                  false
                );

                startbutton.addEventListener(
                  "click",
                  function (ev) {
                    takepicture();
                    ev.preventDefault();
                  },
                  false
                );
              } catch (err) {
                console.log(err);
              }
            }
            let token;

            function takepicture() {
              let context = canvas.getContext("2d");
              canvas.width = video.videoWidth;
              canvas.height = video.videoHeight;
              context.drawImage(
                video,
                0,
                0,
                video.videoWidth,
                video.videoHeight
              );
              previewElem.innerHTML = `<div class="preview_content"></div>
          <div class="video"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; background: rgb(255, 255, 255); display: block; shape-rendering: auto;" width="200px" height="200px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
<circle cx="50" cy="50" fill="none" stroke="#3adc99" stroke-width="10" r="35" stroke-dasharray="164.93361431346415 56.97787143782138">
  <animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="0.8s" values="0 50 50;360 50 50" keyTimes="0;1"/>
</circle>
<!-- [ldio] generated by https://loading.io/ --></svg></div>
          <div class="retry"></div>`;
              let data = canvas.toDataURL("image/png");

              startbutton.remove();
              fetch("/wall", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json;charset=utf-8",
                },
                body: JSON.stringify({ base64: data }),
              })
                .finally(() => {})
                .then((response) => {
                  return response.text();
                })
                .then((text) => {
video.remove();
                  previewElem.style.borderColor = "#0000000d";
                  text = text.trim();
                previewElem.querySelector('.video').remove();
                  if(text != 'good'){
                    previewElem.style.maxHeight = "165px";
                    let button = document.createElement('button');
                    button.innerText = '–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞';
                    
                    button.onclick = function () {
                      previewElem.innerHTML = "";
                      previewElem.innerHTML =
                        `<div class="preview_content"></div>
          <video class="video">–û—à–∏–±–∫–∞.</video>
          <div class="retry"></div>`;

                      previewElem.style.maxHeight = "1000px";
                      document.querySelector(".photo_div").innerHTML =
                        '<button class="photo">–°–Ω—è—Ç—å —Ñ–æ—Ç–æ</button>';
                      startup();
                    };
document.querySelector('.retry').appendChild(button)
                  }
                  else{
                      
                    previewElem.style.maxHeight = "107px";
                  }
                
const contentElem = document.querySelector(".preview_content");
                  switch (text) {
                    case "good":
                      contentElem.innerHTML =
                        "<h1>üòé</h1><p>–í—Å—ë –≥–æ—Ç–æ–≤–æ.</p>";
                      nextElem.removeAttribute("disabled");
                      
                      break;
                    case "bad":
                     contentElem.innerHTML =
                        '<h1>üòü</h1><p>–û—à–∏–±–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞.</p>';
                      
                      break;
                    case "fake":
                      contentElem.innerHTML =
                        '<h1>üòü</h1><p>–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.</p>';
                      
                      break;
                    case "face1":
                      contentElem.innerHTML =
                        '<h1>üòü</h1><p>–ù–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –ª–∏—Ü–æ.</p>';
                      
                      break;
                    case "face2":
                      contentElem.innerHTML =
                        '<h1>üòü</h1><p>–ù–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –±–æ–ª—å—à–µ, —á–µ–º –æ–¥–Ω–æ –ª–∏—Ü–æ.</p>';
                      
                      break;
                    default:
                      contentElem.innerHTML =
                        '<h1>üòü</h1><p>–û—à–∏–±–∫–∞.</p>';
                        
                  }
                 
                });
            }
            document.querySelector(".next").onclick = function () {
              let avatar;
              let file = document.querySelector('input[type="file"]').files[0];

              let reader = new FileReader();
              if (file !== undefined) {
                reader.readAsBinaryString(file);

                reader.onload = function () {
                  fetch("https://api.yundu.co/avatar", {
                    method: "POST",
                    headers: {
                      "Content-Type": "application/json;charset=utf-8",
                    },
                    body: JSON.stringify({ image: btoa(reader.result) }),
                  })
                    .then((response) => {
                      return response.text();
                    })
                    .then((text) => {
                      avatar = text;
                      fetch("https://api.yundu.co/signup", {
                        method: "POST",
                        headers: {
                          "Content-Type": "application/json;charset=utf-8",
                        },
                        body: JSON.stringify({
                          avatar: avatar,
                          username: userInputs.username.value,
                          email: userInputs.email.value,
                          password: userInputs.password.value,
                          name: userInputs.name.value,
                          surname: userInputs.surname.value,
                        }),
                      })
                        .then((response) => {
                          return response.json();
                        })
                        .then((text) => {
                          msgElem.innerText = "";
                          if (text.msg) {
                            if (text.msg == "save error") {
                              msgElem.innerText = "–û—à–∏–±–∫–∞.";
                            }
                          } else {
                            if (text.errors) {
                              msgElem.innerText = "–û—à–∏–±–∫–∞.";
                            } else {
                              if (text.token) {
                                token = text.token;
                                fetch("https://api.yundu.co/me", {
                                  headers: {
                                    "Content-Type": "application/json",
                                    token: text.token,
                                  },
                                })
                                  .then((response) => response.json())
                                  .then((text) => {
                                    if (text.data.username) {
                                      
                                      localStorage.setItem("logged", true);

                                      if (env.toString() == "production") {
                                        let iframe = document.createElement(
                                          "iframe"
                                        );
                                        
                                        iframe.setAttribute(
                                          "src",
                                          "https://app.yundu.co/me/" +
                                            token
                                        );
                                        iframe.style.display = "none";
                                        document.body.appendChild(iframe);
                                        function listener(event){
if(event.data && event.data == 'success'){
    location.href = 'https://app.yundu.co/'
}
else if(event.data && event.data == 'error'){
    console.log('error')
}
else{
    console.log(data)
}
}
window.addEventListener("message", listener);
            document.querySelector('.toAppBg').classList.add('active')
                                      } else if (
                                        env.toString() == "development"
                                      ) {
                                        location.href = "/app/";
                                      }
                                    }
                                  });
                              }
                            }
                          }
                        });
                    });
                };
              } else {
                avatar = 'no';
                      fetch("https://api.yundu.co/signup", {
                        method: "POST",
                        headers: {
                          "Content-Type": "application/json;charset=utf-8",
                        },
                        body: JSON.stringify({
                          avatar: avatar,
                          username: userInputs.username.value,
                          email: userInputs.email.value,
                          password: userInputs.password.value,
                          name: userInputs.name.value,
                          surname: userInputs.surname.value,
                        }),
                      })
                        .then((response) => {
                          return response.json();
                        })
                        .then((text) => {
                          msgElem.innerText = "";
                          if (text.msg) {
                            if (text.msg == "save error") {
                              msgElem.innerText = "–û—à–∏–±–∫–∞.";
                            }
                          } else {
                            if (text.errors) {
                              msgElem.innerText = "–û—à–∏–±–∫–∞.";
                            } else {
                              if (text.token) {
                                token = text.token;
                                fetch("https://api.yundu.co/me", {
                                  headers: {
                                    "Content-Type": "application/json",
                                    token: text.token,
                                  },
                                })
                                  .then((response) => response.json())
                                  .then((text) => {
                                    if (text.data.username) {
                                      localStorage.setItem("logged", true);

                                      if (env.toString() == "production") {
                                        let iframe = document.createElement(
                                          "iframe"
                                        );
                                        
                                        iframe.setAttribute(
                                          "src",
                                          "https://app.yundu.co/me/" +
                                            token
                                        );
                                        iframe.style.display = "none";
                                        document.body.appendChild(iframe);
                                        function listener(event){
if(event.data && event.data == 'success'){
    location.href = 'https://app.yundu.co/'
}
else if(event.data && event.data == 'error'){
    console.log('error')
}
else{
    console.log(data)
}
}
window.addEventListener("message", listener);
            document.querySelector('.toAppBg').classList.add('active')
                                      } else if (
                                        env.toString() == "development"
                                      ) {
                                        location.href = "/app/";
                                      }
                                    }
                                  });
                              }
                            }
                          }
                        });
              }
            };
          }
        });
    </script>
  </body>
</html>
